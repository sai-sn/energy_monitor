Version 4
SHEET 1 6628 2468
WIRE 864 -736 736 -736
WIRE 1136 -736 864 -736
WIRE 864 -720 864 -736
WIRE 1280 -720 992 -720
WIRE -1648 -704 -1648 -736
WIRE 1136 -656 1136 -736
WIRE 992 -640 992 -720
WIRE 1104 -640 992 -640
WIRE -624 -624 -640 -624
WIRE -544 -624 -560 -624
WIRE -432 -624 -464 -624
WIRE -368 -624 -432 -624
WIRE -320 -624 -368 -624
WIRE -32 -624 -64 -624
WIRE 64 -624 -32 -624
WIRE 176 -624 64 -624
WIRE 256 -624 176 -624
WIRE 1280 -624 1280 -720
WIRE 1280 -624 1168 -624
WIRE 1344 -624 1280 -624
WIRE 864 -608 864 -640
WIRE 1104 -608 864 -608
WIRE -1184 -576 -1184 -624
WIRE -1024 -576 -1184 -576
WIRE -928 -576 -1024 -576
WIRE 864 -576 864 -608
WIRE -1648 -560 -1648 -624
WIRE -1184 -528 -1184 -576
WIRE -1024 -528 -1024 -576
WIRE 864 -464 864 -496
WIRE -1648 -432 -1648 -480
WIRE -1536 -432 -1648 -432
WIRE -1504 -432 -1536 -432
WIRE -1024 -432 -1024 -464
WIRE -464 -400 -464 -624
WIRE -368 -400 -368 -624
WIRE -32 -400 -32 -624
WIRE 64 -400 64 -624
WIRE 176 -400 176 -624
WIRE -1648 -368 -1648 -432
WIRE -1648 -368 -1680 -368
WIRE -1616 -368 -1648 -368
WIRE -1536 -336 -1536 -368
WIRE 864 -336 864 -384
WIRE -1648 -288 -1680 -288
WIRE -1616 -288 -1648 -288
WIRE -1648 -256 -1648 -288
WIRE 1008 -256 864 -256
WIRE 1136 -256 1136 -592
WIRE 1136 -256 1008 -256
WIRE -1536 -224 -1536 -272
WIRE -464 -224 -464 -336
WIRE -368 -224 -368 -336
WIRE -368 -224 -464 -224
WIRE -192 -224 -192 -528
WIRE -192 -224 -368 -224
WIRE -96 -224 -192 -224
WIRE -32 -224 -32 -336
WIRE -32 -224 -96 -224
WIRE 64 -224 64 -336
WIRE 64 -224 -32 -224
WIRE 176 -224 176 -320
WIRE 176 -224 64 -224
WIRE -1808 176 -1872 176
WIRE -1792 176 -1808 176
WIRE -1680 176 -1712 176
WIRE -2128 240 -2176 240
WIRE -1872 240 -2048 240
WIRE -1808 240 -1808 176
WIRE -1808 240 -1872 240
WIRE -1600 240 -1744 240
WIRE -1808 256 -1808 240
WIRE -1776 256 -1808 256
WIRE -1680 272 -1680 176
WIRE -1680 272 -1712 272
WIRE -1616 272 -1680 272
WIRE -1200 272 -1216 272
WIRE -1072 272 -1120 272
WIRE -1008 272 -1072 272
WIRE -1776 288 -1872 288
WIRE -2128 304 -2176 304
WIRE -2000 304 -2048 304
WIRE -1872 304 -1872 288
WIRE -1872 304 -2000 304
WIRE -1072 304 -1072 272
WIRE -1872 320 -1872 304
WIRE -1744 320 -1744 304
WIRE -2000 336 -2000 304
WIRE -576 384 -592 384
WIRE -448 400 -512 400
WIRE -576 416 -592 416
WIRE -544 464 -544 432
WIRE -1840 912 -1904 912
WIRE -1824 912 -1840 912
WIRE -1712 912 -1744 912
WIRE -1904 976 -2064 976
WIRE -1840 976 -1840 912
WIRE -1840 976 -1904 976
WIRE -1616 976 -1776 976
WIRE -1840 992 -1840 976
WIRE -1808 992 -1840 992
WIRE -1712 1008 -1712 912
WIRE -1712 1008 -1744 1008
WIRE -1632 1008 -1712 1008
WIRE -1072 1008 -1120 1008
WIRE -1008 1008 -1072 1008
WIRE -2000 1024 -2064 1024
WIRE -1872 1024 -2000 1024
WIRE -1808 1024 -1872 1024
WIRE -1072 1040 -1072 1008
WIRE -2000 1056 -2000 1024
WIRE -1872 1056 -1872 1024
WIRE -1776 1056 -1776 1040
WIRE -576 1152 -592 1152
WIRE -1872 1168 -1872 1136
WIRE -448 1168 -512 1168
WIRE -576 1184 -592 1184
WIRE -544 1232 -544 1200
FLAG -432 -624 Vin
FLAG -1008 272 Vis_filtered
FLAG -1008 1008 Vvs_filtered
FLAG -448 400 Vicomparator
FLAG -448 1168 Vvcomparator
FLAG 256 -624 5_Volt_Line
FLAG -640 -624 Vac
FLAG 1344 -624 2.1_Volt_Line
FLAG 736 -736 5_Volt_Line
FLAG -96 -224 0
FLAG 1008 -256 0
FLAG -544 1232 0
FLAG -544 1136 5_Volt_Line
FLAG -592 1152 2.1_Volt_Line
FLAG -592 1184 Vvs_filtered
FLAG -2128 -640 0
FLAG -2128 -720 Vac
FLAG -1648 -736 Vac
FLAG -1648 -256 0
FLAG -1504 -432 Vis
FLAG -1744 320 0
FLAG -544 464 0
FLAG -2176 240 0
FLAG -1536 -224 0
FLAG -1072 368 0
FLAG -2176 304 Vis
FLAG -544 368 5_Volt_Line
FLAG -1600 240 5_Volt_Line
FLAG -1616 976 5_Volt_Line
FLAG -1872 1168 2.1_Volt_Line
FLAG -1776 1056 0
FLAG -2144 976 0
FLAG -1184 -448 0
FLAG -1024 -368 0
FLAG -1872 400 2.1_Volt_Line
FLAG -592 384 2.1_Volt_Line
FLAG -1184 -704 Vac
FLAG -928 -576 Vvs
FLAG -2144 1024 Vvs
FLAG -1616 272 Vis_unfiltered
FLAG -1216 272 Vis_unfiltered
FLAG -1072 1104 0
FLAG -592 416 Vis_filtered
FLAG -1632 1008 Vvs_unfiltered
FLAG -1200 1008 Vvs_unfiltered
FLAG -2000 1120 0
FLAG -2000 400 0
SYMBOL ind -1664 -720 R0
SYMATTR InstName L1
SYMATTR Value 40mH
SYMBOL res -1664 -576 R0
SYMATTR InstName R1
SYMATTR Value 17.034
SYMBOL voltage -2128 -736 R0
WINDOW 39 0 0 Left 0
WINDOW 0 -95 135 Left 2
WINDOW 3 -98 169 Left 2
SYMATTR InstName Vac
SYMATTR Value SINE(0 19.79898987 50)
SYMATTR Value2 AC 19.79898987
SYMBOL res -1200 -720 R0
SYMATTR InstName R3
SYMATTR Value 82k
SYMBOL res -1200 -544 R0
SYMATTR InstName R4
SYMATTR Value 3.9k
SYMBOL PowerProducts/LT1085-5 -192 -624 R0
SYMATTR InstName Reg1
SYMBOL res -448 -640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rin1
SYMATTR Value 33
SYMBOL diode -624 -608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap -480 -400 R0
SYMATTR InstName Cin1
SYMATTR Value 470µ
SYMATTR SpiceLine Rser=0.001
SYMBOL cap 48 -400 R0
SYMATTR InstName Cout1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=0.001
SYMBOL Opamps/opamp2 1136 -688 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 848 -736 R0
SYMATTR InstName R8
SYMATTR Value 39k
SYMBOL res 848 -592 R0
SYMATTR InstName R9
SYMATTR Value 27k
SYMBOL res 848 -352 R0
SYMATTR InstName R11
SYMATTR Value 39
SYMBOL res 848 -480 R0
SYMATTR InstName R10
SYMATTR Value 1.2k
SYMBOL Opamps/opamp2 -1744 208 R0
WINDOW 0 36 88 Left 2
WINDOW 3 39 117 Left 2
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL res -2032 288 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R12
SYMATTR Value 3.9k
SYMBOL res -2032 224 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R13
SYMATTR Value 3.9k
SYMBOL res -1696 160 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R14
SYMATTR Value 8.2k
SYMBOL res -1856 416 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -65 30 Left 2
SYMATTR InstName R15
SYMATTR Value 8.2k
SYMBOL res -1104 256 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 4.7k
SYMBOL cap -1056 368 R180
WINDOW 0 -54 34 Left 2
WINDOW 3 -66 8 Left 2
SYMATTR InstName Cf2
SYMATTR Value 3.3n
SYMBOL Opamps/opamp2 -1776 944 R0
WINDOW 0 31 90 Left 2
WINDOW 3 31 117 Left 2
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res -2048 1008 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R6
SYMATTR Value 18k
SYMBOL res -2048 960 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R16
SYMATTR Value 22k
SYMBOL res -1728 896 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R17
SYMATTR Value 22k
SYMBOL res -1856 1152 R180
WINDOW 0 -57 68 Left 2
WINDOW 3 -53 40 Left 2
SYMATTR InstName R18
SYMATTR Value 22k
SYMBOL res -1104 992 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf3
SYMATTR Value 4.7k
SYMBOL cap -1056 1104 R180
WINDOW 0 -49 35 Left 2
WINDOW 3 -63 9 Left 2
SYMATTR InstName Cf3
SYMATTR Value 3.3n
SYMBOL res 160 -416 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL Opamps/opamp2 -544 336 R0
WINDOW 0 29 91 Left 2
WINDOW 3 32 119 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL Opamps/opamp2 -544 1104 R0
WINDOW 0 27 85 Left 2
WINDOW 3 28 110 Left 2
SYMATTR InstName U5
SYMATTR Value LM324
SYMBOL res -1632 -384 R0
WINDOW 0 38 48 Left 2
SYMATTR InstName R2
SYMATTR Value 1.2
SYMBOL res -1696 -384 R0
WINDOW 0 -38 46 Left 2
WINDOW 3 -37 73 Left 2
SYMATTR InstName R7
SYMATTR Value 1
SYMBOL zener -1040 -432 R0
WINDOW 0 55 30 Left 2
WINDOW 3 56 56 Left 2
SYMATTR InstName D4
SYMBOL zener -1008 -464 R180
WINDOW 0 -50 31 Left 2
WINDOW 3 -37 5 Left 2
SYMATTR InstName D5
SYMBOL zener -1552 -336 R0
WINDOW 0 49 26 Left 2
WINDOW 3 50 50 Left 2
SYMATTR InstName D6
SYMBOL zener -1520 -368 R180
WINDOW 0 -46 29 Left 2
WINDOW 3 -31 3 Left 2
SYMATTR InstName D7
SYMBOL cap -2016 1056 R0
WINDOW 0 47 26 Left 2
WINDOW 3 47 52 Left 2
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL cap -1920 912 R0
WINDOW 0 -44 19 Left 2
WINDOW 3 -58 48 Left 2
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL cap -2016 336 R0
WINDOW 0 43 14 Left 2
WINDOW 3 43 42 Left 2
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL cap -1888 176 R0
WINDOW 0 -49 12 Left 2
WINDOW 3 -64 43 Left 2
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL cap -48 -400 R0
SYMATTR InstName C5
SYMATTR Value 100n
SYMBOL cap -384 -400 R0
SYMATTR InstName C6
SYMATTR Value 100n
TEXT -2192 -352 Left 2 ;.ac dec 30 1 1Meg
TEXT -2192 -416 Left 2 !.lib LM324.lib
TEXT -2200 -480 Left 2 ;Simulation Commands\n- Change these as needed
TEXT -2192 -384 Left 2 !.tran 0 1 0 0.1m
TEXT -2192 -320 Left 2 !.ic V(Vin)=8
TEXT -1280 -816 Left 2 ;Load Voltage Stepdown Divider
TEXT -1280 -296 Left 2 ;G = 45.402*10^-3
TEXT -2240 800 Left 2 ;Load Voltage DC Offset OpAmp
TEXT -2240 1368 Left 2 ;G = 1
TEXT -2240 1400 Left 2 ;DC Offset added : 2.1 Volts
TEXT -2240 1440 Left 2 ;Note: R16 = R17 = R18 = (R6 + Rthevenin) for G = 1.
TEXT -1392 912 Left 2 ;Load Voltage 1st Order Filter Circuit
TEXT -1392 1328 Left 2 ;Cutoff Frequency: 1KHz
TEXT 560 -816 Left 2 ;OpAmp Voltage Follower DC Offset
TEXT 568 -192 Left 2 ;Voltage divider DC offset created: 2.1 Volts
TEXT 568 -152 Left 2 ;Voltage follower: G = 1
TEXT -2240 56 Left 2 ;Load Current (represented by Voltage) DC offset opamp
TEXT -1768 -184 Left 2 ;Shunt resistor for voltage divider
TEXT -1768 -144 Left 2 ;Voltage across R2 used to measure current
TEXT -1384 560 Left 2 ;Cutoff Frequency: 1KHz
TEXT -1392 144 Left 2 ;Load Current 1st Order Filter Circuit
TEXT -2240 664 Left 2 ;DC offset of 2.1 Added
TEXT -2240 624 Left 2 ;G = 2.1
TEXT -1768 -104 Left 2 ;G = variable depending on R1
TEXT -2240 -848 Left 2 ;Source voltage varies \nfrom 12.6 to 15.4 V RMS
TEXT -1744 -840 Left 2 ;RLoad (R1) varies from \n17.034 to 94.86 ohms
TEXT -704 -816 Left 2 ;Linear Voltage Regulator
TEXT -800 928 Left 2 ;Voltage Zero Crossing Detector
TEXT -808 176 Left 2 ;Current Zero Crossing Detector
LINE Normal -864 176 -1392 176 1
LINE Normal -864 528 -864 176 1
LINE Normal -1392 528 -864 528 1
LINE Normal -1392 176 -1392 528 1
RECTANGLE Normal -1520 -464 -1744 -784 1
RECTANGLE Normal -1440 592 -2240 96 1
RECTANGLE Normal -1440 1344 -2240 832 1
RECTANGLE Normal -848 1296 -1392 944 1
RECTANGLE Normal -272 528 -816 208 1
RECTANGLE Normal -832 -336 -1296 -784 1
RECTANGLE Normal -1760 -448 -1424 -208 1
RECTANGLE Normal -1856 -544 -2240 -784 1
RECTANGLE Normal 432 -176 -704 -784 1
RECTANGLE Normal 1536 -224 560 -784 1
RECTANGLE Normal -256 1296 -800 960 1
RECTANGLE Normal -1856 -288 -2240 -512 1
